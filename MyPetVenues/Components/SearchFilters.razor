@using MyPetVenues.Models

<div class="search-filters">
    <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" 
               placeholder="Search venues, cities..." 
               @bind="SearchTerm" 
               @bind:event="oninput"
               @onkeyup="OnSearchKeyUp" />
        @if (!string.IsNullOrEmpty(SearchTerm))
        {
            <button class="clear-btn" @onclick="ClearSearch">âœ•</button>
        }
    </div>
    
    <div class="filter-row">
        <div class="filter-group">
            <label>Venue Type</label>
            <select @bind="SelectedVenueType">
                <option value="">All Types</option>
                @foreach (var type in Enum.GetValues<VenueType>())
                {
                    <option value="@type">@GetVenueTypeDisplay(type)</option>
                }
            </select>
        </div>
        
        <div class="filter-group">
            <label>Pet Type</label>
            <select @bind="SelectedPetType">
                <option value="">All Pets</option>
                @foreach (var type in Enum.GetValues<PetType>())
                {
                    <option value="@type">@GetPetTypeDisplay(type)</option>
                }
            </select>
        </div>
        
        <button class="search-btn" @onclick="ApplyFilters">
            ğŸ” Search
        </button>
    </div>
</div>

@code {
    [Parameter]
    public string? SearchTerm { get; set; }

    [Parameter]
    public VenueType? SelectedVenueType { get; set; }

    [Parameter]
    public PetType? SelectedPetType { get; set; }

    [Parameter]
    public EventCallback<(string? SearchTerm, VenueType? VenueType, PetType? PetType)> OnSearch { get; set; }

    private async Task ApplyFilters()
    {
        await OnSearch.InvokeAsync((SearchTerm, SelectedVenueType, SelectedPetType));
    }

    private async Task OnSearchKeyUp(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            await ApplyFilters();
        }
    }

    private async Task ClearSearch()
    {
        SearchTerm = "";
        await ApplyFilters();
    }

    private string GetVenueTypeDisplay(VenueType type) => type switch
    {
        VenueType.Park => "ğŸŒ³ Park",
        VenueType.Restaurant => "ğŸ½ï¸ Restaurant",
        VenueType.Cafe => "â˜• CafÃ©",
        VenueType.Hotel => "ğŸ¨ Hotel",
        VenueType.Store => "ğŸ›ï¸ Store",
        VenueType.Beach => "ğŸ–ï¸ Beach",
        VenueType.DayCare => "ğŸ  Day Care",
        VenueType.Grooming => "âœ‚ï¸ Grooming",
        VenueType.VetClinic => "ğŸ¥ Vet Clinic",
        _ => type.ToString()
    };

    private string GetPetTypeDisplay(PetType type) => type switch
    {
        PetType.Dog => "ğŸ• Dogs",
        PetType.Cat => "ğŸ± Cats",
        PetType.Bird => "ğŸ¦ Birds",
        PetType.Rabbit => "ğŸ° Rabbits",
        PetType.SmallPet => "ğŸ¹ Small Pets",
        PetType.All => "ğŸ¾ All Pets",
        _ => type.ToString()
    };
}
